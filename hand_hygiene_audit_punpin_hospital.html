<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏°‡∏∑‡∏≠ ‚Äì ‡∏£‡∏û.‡∏û‡∏∏‡∏ô‡∏û‡∏¥‡∏ô</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: 'Kanit', sans-serif; background:#f4f6f8; margin:0; padding:20px; }
    h1,h2,h3 { margin-top:0 }
    .card { background:#fff; border-radius:12px; padding:16px; margin-bottom:16px; box-shadow:0 2px 6px rgba(0,0,0,.08)}
    label { display:block; margin-top:8px }
    select,input { padding:6px; margin-top:4px }
    table { width:100%; border-collapse:collapse; margin-top:8px }
    th,td { border:1px solid #ccc; padding:6px; text-align:center }
    button { padding:10px 16px; border:none; border-radius:8px; background:#2563eb; color:#fff; cursor:pointer }
    button.secondary { background:#16a34a }
    button.warn { background:#dc2626 }
    .grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); gap:12px }
    .small { font-size:13px; color:#555 }
  </style>
</head>
<body>
<h1>üìã ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏°‡∏∑‡∏≠<br><span class="small">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏û‡∏∏‡∏ô‡∏û‡∏¥‡∏ô</span></h1>

<div class="card">
<h2>1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h2>
<label>‡∏´‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
<select id="ward">
  <option>OPD</option><option>IPD</option><option>LR</option><option>ER</option><option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
</select></label>
<label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <input type="date" id="date"></label>
<label>‡πÄ‡∏ß‡∏•‡∏≤ <input type="time" id="time"></label>
</div>

<div class="card">
<h2>2. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</h2>
<div class="grid">
<label>‡∏≠‡πà‡∏≤‡∏á‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠ <select id="sink"><option>‡∏°‡∏µ</option><option>‡πÑ‡∏°‡πà‡∏°‡∏µ</option></select></label>
<label>‡∏™‡∏ö‡∏π‡πà‡πÄ‡∏´‡∏•‡∏ß <select id="soap"><option>‡∏°‡∏µ</option><option>‡πÑ‡∏°‡πà‡∏°‡∏µ</option></select></label>
<label>4% Chlorhexidine <select id="chx"><option>‡∏°‡∏µ</option><option>‡πÑ‡∏°‡πà‡∏°‡∏µ</option></select></label>
<label>Alcohol hand rub <select id="ahr"><option>‡∏°‡∏µ</option><option>‡πÑ‡∏°‡πà‡∏°‡∏µ</option></select></label>
<label>‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡πÄ‡∏ä‡πá‡∏î‡∏°‡∏∑‡∏≠ <select id="towel"><option>‡∏°‡∏µ</option><option>‡πÑ‡∏°‡πà‡∏°‡∏µ</option></select></label>
<label>‡πÇ‡∏õ‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏•‡πâ‡∏≤‡∏á‡∏°‡∏∑‡∏≠ <select id="poster"><option>‡∏°‡∏µ</option><option>‡πÑ‡∏°‡πà‡∏°‡∏µ</option></select></label>
<label>‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞ <select id="bin"><option>‡∏°‡∏µ</option><option>‡πÑ‡∏°‡πà‡∏°‡∏µ</option></select></label>
</div>
</div>

<div class="card">
<h2>3. ‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°</h2>
<label>‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û
<select id="role">
<option>‡πÅ‡∏û‡∏ó‡∏¢‡πå</option><option>‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</option><option>‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ</option><option>‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</option><option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
</select></label>

<table>
<tr><th>‡πÇ‡∏≠‡∏Å‡∏≤‡∏™</th><th>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥</th></tr>
<script>
const moments=[
'‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢','‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏´‡∏±‡∏ï‡∏ñ‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏≠‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠','‡∏´‡∏•‡∏±‡∏á‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏™‡∏≤‡∏£‡∏Ñ‡∏±‡∏î‡∏´‡∏•‡∏±‡πà‡∏á','‡∏´‡∏•‡∏±‡∏á‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢','‡∏´‡∏•‡∏±‡∏á‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏™‡∏¥‡πà‡∏á‡∏£‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢'
];
for(let i=0;i<moments.length;i++){
 document.write(`<tr><td>${moments[i]}</td><td>
 <select id="m${i}">
 <option value="HW">HW</option>
 <option value="HR">HR</option>
 <option value="NO">‡πÑ‡∏°‡πà‡∏•‡πâ‡∏≤‡∏á</option>
 <option value="G">‡πÉ‡∏™‡πà‡∏ñ‡∏∏‡∏á‡∏°‡∏∑‡∏≠</option>
 </select></td></tr>`);
}
</script>
</table>
</div>

<div class="card">
<button onclick="saveData()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
<button class="secondary" onclick="showReport()">üìä ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
<button class="warn" onclick="exportCSV()">‚¨á Export Excel (CSV)</button>
</div>

<div class="card" id="report"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
function getAll(){ return JSON.parse(localStorage.getItem('hh_data')||'[]'); }
function saveAll(d){ localStorage.setItem('hh_data',JSON.stringify(d)); }

function saveData(){
 let rec={
 ward:ward.value,date:date.value,time:time.value,role:role.value,
 equip:{sink:sink.value,soap:soap.value,chx:chx.value,ahr:ahr.value,towel:towel.value,poster:poster.value,bin:bin.value},
 moments:[]
 };
 for(let i=0;i<5;i++) rec.moments.push(document.getElementById('m'+i).value);
 let all=getAll(); all.push(rec); saveAll(all);
 alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß');
}

function showReport(){
 let all=getAll(); if(all.length==0){report.innerHTML='‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•'; return}
 let total=all.length*5;
 let clean=0; let byRole={}; let hw=0; let hr=0;
 all.forEach(r=>{
  if(!byRole[r.role]) byRole[r.role]={t:0,c:0};
  r.moments.forEach(m=>{
   byRole[r.role].t++;
   if(m=='HW'||m=='HR'){ clean++; byRole[r.role].c++; }
   if(m=='HW') hw++; if(m=='HR') hr++;
  });
 });
 let html=`<h2>üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ</h2>`;
 html+=`<p>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏°‡∏∑‡∏≠‡∏£‡∏ß‡∏°: <b>${(clean/total*100).toFixed(1)}%</b></p>`;
 html+=`<p>HW ${(hw/(hw+hr)*100||0).toFixed(1)}% | HR ${(hr/(hw+hr)*100||0).toFixed(1)}%</p>`;
 html+=`<h3>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏ï‡∏≤‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û</h3><ul>`;
 for(let r in byRole){ html+=`<li>${r}: ${(byRole[r].c/byRole[r].t*100).toFixed(1)}%</li>` }
 html+='</ul>';
 report.innerHTML=html;
}

function exportCSV(){
 let all=getAll(); if(all.length==0){alert('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');return}
 let csv='ward,date,time,role,m1,m2,m3,m4,m5\n';
 all.forEach(r=>{
 csv+=`${r.ward},${r.date},${r.time},${r.role},${r.moments.join(',')}\n`;
 });
 let blob=new Blob([csv],{type:'text/csv'});
 let a=document.createElement('a'); a.href=URL.createObjectURL(blob);
 a.download='hand_hygiene.csv'; a.click();
}
</script>
</body>
</html>
